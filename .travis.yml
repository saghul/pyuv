language: python
sudo: false
matrix:
  include:
    - python: 3.5
    - python: 3.6
    - python: 3.7
      dist: xenial
      sudo: true
    - python: pypy3
    - os: osx
      name: Python (macOS)
      language: generic

branches:
  only:
    - master
    - v1.x

cache: pip
before_install:
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew list python3 &>/dev/null || brew install python3; fi
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then ulimit -n 10000; fi
install:
    - python3 --version
    - pip3 --version
    - pip3 install tox
script:
    - tox -e py3

notifications:
  email:
    on_success: never
    on_failure: change
